!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("infestines"),require("react"),require("kefir")):"function"==typeof define&&define.amd?define(["exports","infestines","react","kefir"],n):n(r.karet={},r.I,r.React,r.Kefir)}(this,function(r,n,e,t){"use strict";function i(r){var n=r._currentEvent;if(n)return n.value}function f(r){for(var e=r,t=0,o=r.length;t<o;++t){var a=r[t],u=U(a)?i(a):n.isArray(a)?f(a):a;void 0===u&&(u=null),a!==u&&(e===r&&(e=r.slice(0)),e[t]=u)}return e}function o(r){var n=null;for(var e in r){var t=r[e];if(U(t)){if(!n)for(var f in n={},r){if(f===e)break;n[f]=r[f]}n[e]=i(t)}else n&&(n[e]=t)}return n||r}function a(r,e,t,i){for(var f=e.length;r<f;++r){var o=e[r];U(o)?i(t,o):n.isArray(o)&&a(0,o,t,i)}}function u(r,e,t){for(var i in r){var f=r[i];if(U(f))t(e,f);else if(E===i)n.isArray(f)&&a(0,f,e,t);else if(k===i||w===i)for(var o in f){var u=f[o];U(u)&&t(e,u)}}}function l(r,n){n.offAny(r)}function s(r,n){n.onAny(r)}function c(r,n){var e=n.args,t=r.h;t||(t=r.h=function(n){var e=n.type;if(e===m)r.forceUpdate();else if(e===A)throw n.value}),u(e[1],t,s),a(2,e,t,s)}function v(r,n){var e=n.args,t=r.h;t&&(a(2,e,t,l),u(e[1],t,l))}function p(r,n){r.set(n,(r.get(n)||0)-1)}function h(r,n){r.set(n,(r.get(n)||0)+1)}function d(r,n,e){if(r<0)do{n.offAny(e.h)}while(++r);else if(0<r)do{n.onAny(e.h)}while(--r)}function y(r,e){for(var t=e.length;r<t;++r){var i=e[r];if(U(i)||n.isArray(i)&&y(0,i))return!0}return!1}function g(r){var t=r[1];if(function(r){for(var e in r){var t=r[e];if(U(t))return!0;if(E===e){if(n.isArray(t)&&y(0,t))return!0}else if(k===e||w===e)for(var i in t)if(U(t[i]))return!0}return!1}(t)||y(2,r)){var i={args:r};if(t){var f=t.key;null!=f&&(i.key=f)}return e.createElement(P,i)}return e.createElement.apply(null,r)}var m="value",A="error",k="style",w="dangerouslySetInnerHTML",E="children",U=function(r){return r instanceof t.Property},b="undefined"==typeof window?{h:null,forceUpdate:function(){}}:null,P=n.inherit(function(r){e.Component.call(this,r),(this.h=b)&&(this.state=n.object0)},e.Component,{componentDidMount:function(){c(this,this.props)},componentDidUpdate:function(r){var n=r.args,e=this.props.args,t=new Map;t.h=this.h,u(n[1],t,p),a(2,n,t,p),u(e[1],t,h),a(2,e,t,h),t.forEach(d)},componentWillUnmount:function(){v(this,this.props)},render:function(){if(this.h){var r=this.props.args,t=r.length,a=Array(t);a[0]=r[0],a[1]=function(r){var e=null;for(var t in r){var a=r[t],u=U(a)?i(a):E===t?n.isArray(a)?f(a):a:k===t||w===t?o(a):a;if(a!==u){if(!e)for(var l in e={},r){if(l===t)break;e[l]=r[l]}e[t]=u}else e&&(e[t]=u)}return e||r}(r[1]);for(var u=2;u<t;++u){var l=r[u];void 0===(l=U(l)?i(l):n.isArray(l)?f(l):l)&&(l=null),a[u]=l}return e.createElement.apply(null,a)}return null}},b&&{getDerivedStateFromProps:function(r){return c(b,r),v(b,r),null}});r.Fragment=e.Fragment,r.createElement=function(r,t,i){var f=t&&t["karet-lift"];if(f||n.isString(r)||e.Fragment===r){var o=arguments.length,a=Array(o);a[0]=r,a[1]=f?n.dissocPartialU("karet-lift",t):t;for(var u=2;u<o;++u)a[u]=arguments[u];return g(a)}return e.createElement.apply(null,arguments)},r.fromClass=function(r){return e.forwardRef(function(e,t){return g([r,null==t?e:n.assocPartialU("ref",t,e)])})},Object.defineProperty(r,"__esModule",{value:!0})});
