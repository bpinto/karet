!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("infestines"),require("react"),require("kefir")):"function"==typeof define&&define.amd?define(["exports","infestines","react","kefir"],n):n(r.karet={},r.I,r.React,r.Kefir)}(this,function(r,n,e,t){"use strict";function i(r){var n=r._currentEvent;if(n)return n.value}function f(r){for(var e=r,t=0,a=r.length;t<a;++t){var o=r[t],u=U(o)?i(o):n.isArray(o)?f(o):o;o!==u&&(e===r&&(e=r.slice(0)),e[t]=u)}return e}function a(r){var n=null;for(var e in r){var t=r[e];if(U(t)){if(!n)for(var f in n={},r){if(f===e)break;n[f]=r[f]}n[e]=i(t)}else n&&(n[e]=t)}return n||r}function o(r,e,t,i){for(var f=e.length;r<f;++r){var a=e[r];U(a)?i(t,a):n.isArray(a)&&o(0,a,t,i)}}function u(r,e,t){for(var i in r){var f=r[i];if(U(f))t(e,f);else if(E===i)n.isArray(f)&&o(0,f,e,t);else if(k===i||w===i)for(var a in f){var u=f[a];U(u)&&t(e,u)}}}function l(r,n){n.offAny(r)}function s(r,n){n.onAny(r)}function c(r,n){var e=n.args,t=r.h;t||(t=r.h=function(n){var e=n.type;if(e===m)r.forceUpdate();else if(e===A)throw n.value}),u(e[1],t,s),o(2,e,t,s)}function v(r,n){var e=n.args,t=r.h;t&&(o(2,e,t,l),u(e[1],t,l))}function p(r,n){r.set(n,(r.get(n)||0)-1)}function h(r,n){r.set(n,(r.get(n)||0)+1)}function y(r,n,e){if(r<0)do{n.offAny(e.h)}while(++r);else if(0<r)do{n.onAny(e.h)}while(--r)}function d(r,e){for(var t=e.length;r<t;++r){var i=e[r];if(U(i)||n.isArray(i)&&d(0,i))return!0}return!1}function g(r){var t=r[1];if(function(r){for(var e in r){var t=r[e];if(U(t))return!0;if(E===e){if(n.isArray(t)&&d(0,t))return!0}else if(k===e||w===e)for(var i in t)if(U(t[i]))return!0}return!1}(t)||d(2,r)){var i={args:r};if(t){var f=t.key;null!=f&&(i.key=f)}return e.createElement(F,i)}return e.createElement.apply(null,r)}var m="value",A="error",k="style",w="dangerouslySetInnerHTML",E="children",U=function(r){return r instanceof t.Property},b="undefined"==typeof window?{h:null,forceUpdate:function(){}}:null,F=n.inherit(function(r){e.Component.call(this,r),(this.h=b)&&(this.state=n.object0)},e.Component,{componentDidMount:function(){c(this,this.props)},componentDidUpdate:function(r){var n=r.args,e=this.props.args,t=new Map;t.h=this.h,u(n[1],t,p),o(2,n,t,p),u(e[1],t,h),o(2,e,t,h),t.forEach(y)},componentWillUnmount:function(){v(this,this.props)},render:function(){if(this.h){var r=this.props.args,t=r.length,o=Array(t),u=o[0]=r[0];o[1]=function(r){var e=null;for(var t in r){var o=r[t],u=U(o)?i(o):E===t?n.isArray(o)?f(o):o:k===t||w===t?a(o):o;if(o!==u){if(!e)for(var l in e={},r){if(l===t)break;e[l]=r[l]}e[t]=u}else e&&(e[t]=u)}return e||r}(r[1]);for(var l=2;l<t;++l){var s=r[l];o[l]=U(s)?i(s):n.isArray(s)?f(s):s}return u===e.Fragment&&t<4&&null==o[2]?null:e.createElement.apply(null,o)}return null}},b&&{getDerivedStateFromProps:function(r){return c(b,r),v(b,r),null}});r.Fragment=e.Fragment,r.createElement=function(r,t,i){var f=t&&t["karet-lift"];if(f||n.isString(r)||e.Fragment===r){var a=arguments.length,o=Array(a);o[0]=r,o[1]=f?n.dissocPartialU("karet-lift",t):t;for(var u=2;u<a;++u)o[u]=arguments[u];return g(o)}return e.createElement.apply(null,arguments)},r.fromClass=function(r){return e.forwardRef(function(e,t){return g([r,null==t?e:n.assocPartialU("ref",t,e)])})},Object.defineProperty(r,"__esModule",{value:!0})});
