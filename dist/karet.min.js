!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("infestines"),require("react"),require("kefir")):"function"==typeof define&&define.amd?define(["exports","infestines","react","kefir"],e):e(r.karet={},r.I,r.React,r.Kefir)}(this,function(r,e,n,t){"use strict";function i(r){var e=r._currentEvent;if(e)return e.value}function a(r){for(var n=r,t=0,f=r.length;t<f;++t){var o=r[t],u=d(o)?i(o):e.isArray(o)?a(o):o;o!==u&&(n===r&&(n=r.slice(0)),n[t]=u)}return n}function f(r){var e=null;for(var n in r){var t=r[n];if(d(t)){if(!e)for(var a in e={},r){if(a===n)break;e[a]=r[a]}e[n]=i(t)}else e&&(e[n]=t)}return e||r}function o(r,n,t,i){for(var a=n.length;r<a;++r){var f=n[r];d(f)?i(t,f):e.isArray(f)&&o(0,f,t,i)}}function u(r,n,t){for(var i in r){var a=r[i];if(d(a))t(n,a);else if(y===i)e.isArray(a)&&o(0,a,n,t);else if(p===i||h===i)for(var f in a){var u=a[f];d(u)&&t(n,u)}}}function l(r,e){e.offAny(r)}function s(r,e){e.onAny(r)}function c(r,n){for(var t=n.length;r<t;++r){var i=n[r];if(d(i)||e.isArray(i)&&c(0,i))return!0}return!1}function v(r){var t=r[1];if(function(r){for(var n in r){var t=r[n];if(d(t))return!0;if(y===n){if(e.isArray(t)&&c(0,t))return!0}else if(p===n||h===n)for(var i in t)if(d(t[i]))return!0}return!1}(t)||c(2,r)){var i={args:r};if(t){var a=t.key;null!=a&&(i.key=a)}return n.createElement(m,i)}return n.createElement.apply(null,r)}var p="style",h="dangerouslySetInnerHTML",y="children",d=function(r){return r instanceof t.Property},m=e.inherit(function(r){n.Component.call(this,r),this.handler=null},n.Component,{componentWillMount:function(){this.doSubscribe(this.props)},componentWillReceiveProps:function(r){this.componentWillUnmount(),this.doSubscribe(r)},componentWillUnmount:function(){var r=this.handler;if(r){var e=this.props.args;o(2,e,r,l),u(e[1],r,l)}},doSubscribe:function(r){var e=this,n=r.args,t=this.handler=function(r){var n=r.type;if("value"===n)e.forceUpdate();else{if("error"===n)throw r.value;e.handler=null}};u(n[1],t,s),o(2,n,t,s)},render:function(){var r=this.props.args,t=r.length,o=Array(t);o[0]=r[0],o[1]=function(r){var n=null;for(var t in r){var o=r[t],u=d(o)?i(o):y===t?e.isArray(o)?a(o):o:p===t||h===t?f(o):o;if(o!==u){if(!n)for(var l in n={},r){if(l===t)break;n[l]=r[l]}n[t]=u}else n&&(n[t]=u)}return n||r}(r[1]);for(var u=2;u<t;++u){var l=r[u];o[u]=d(l)?i(l):e.isArray(l)?a(l):l}return n.createElement.apply(null,o)}});r.Fragment=n.Fragment,r.createElement=function(r,t,i){var a=t&&t["karet-lift"];if(a||e.isString(r)||n.Fragment===r){var f=arguments.length,o=Array(f);o[0]=r,o[1]=a?e.dissocPartialU("karet-lift",t):t;for(var u=2;u<f;++u)o[u]=arguments[u];return v(o)}return n.createElement.apply(null,arguments)},r.fromClass=function(r){return n.forwardRef(function(n,t){return v([r,void 0===t?n:e.assocPartialU("ref",t,n)])})},Object.defineProperty(r,"__esModule",{value:!0})});
